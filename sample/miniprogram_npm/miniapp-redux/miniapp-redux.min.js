!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).MiniappRedux={})}(this,(function(t){"use strict";var n=null,e=[],r=function(t){if(!n){n=t.subscribe((function(){e.filter((function(t){return t.active})).forEach((function(n){return n(t.getState())}))}))}},i=function(t){var n=["subscribe","dispatch","getState"].filter((function(n){return!t.hasOwnProperty(n)}));n.length>0&&console.warn("This store isn't right...missing "+n.join(","))};function o(){return(o=Object.assign||function(t){for(var n=1;arguments.length>n;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t}).apply(this,arguments)}function c(t,n){if(null==t)return{};var e,r,i={},o=Object.keys(t);for(r=0;o.length>r;r++)0>n.indexOf(e=o[r])&&(i[e]=t[e]);return i}function u(t,n){var e=n.context,r=void 0===e?getApp():e,i=c(n,["context"]),u=r.store;return function(n){var e=o({},i,{page:n});return t(u,e),Object.assign({},n)}}var a=function(t){return"[object Array]"===Object.prototype.toString.call(t)},f=function(t){return"[object Object]"===Object.prototype.toString.call(t)},s=function(t){return"function"==typeof t},p=function(t,n){if(t.length!==n.length)return!1;for(var e=t.length;e>=0;e--)if(!d(t[e],n[e]))return!1;return!0},l=function(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(var e=Object.keys(t),r=0;e.length>r;r++)if(!d(t[e[r]],n[e[r]]))return!1;return!0},d=function(t,n){return t===n||!(!t||!n)&&(a(t)&&a(n)?p(t,n):f(t)&&f(n)?l(t,n):t===n)},h=function(t,n){if(s(n)){for(var e=arguments.length,r=Array(e>2?e-2:0),i=2;e>i;i++)r[i-2]=arguments[i];return"[object Arguments]"===Object.prototype.toString.call(r[0])?n.call.apply(n,[t].concat([].slice.call(r[0]))):n.call.apply(n,[t].concat(r))}},g=function(t,n){var r=t.reducers,i=Object.keys(r),c=function n(e){var c=n.preState,u=function(t,n){if(!n||0===n.length)return{};var e={};return n.forEach((function(n){t.hasOwnProperty(n)&&(e[n]=t[n])})),e}(e,i);c&&d(c,u)||(t.setData(o({},t.data,{},function(t,n){if(!n||0===Object.keys(n).length)return{};var e={};return Object.keys(n).forEach((function(r){t.hasOwnProperty(r)&&(e[n[r]]=t[r])})),e}(u,r))),n.preState=u)};c.index=function(t){return e.push(t)-1}(c),c.active=!0,c.pageName=t.__route__,t.listener=c,c(n.getState())},v=function(t){e.splice(t.listener.index,1),delete t.listener};function y(t,n){var e=n.initMapReducers,r=n.initMapDispatchToProps,i=n.pageLifecycle,o=c(n,["initMapReducers","initMapDispatchToProps","pageLifecycle"]).page;o.reducers=e,r&&(o.props=r(t.dispatch)),i(t,o)}var b,O,j,x,P,m,S,M,k,L,_,w,D=(x=void 0===(j=(O=void 0===b?{}:b).connectHOC)?u:j,m=void 0===(P=O.mapReducersFunc)?function(t){var n={},e=Function.prototype.toString.call(t).replace(/[\s|\;]*/g,"");return(e=e.substring(e.indexOf("return")+7,e.length-2)).split(",").forEach((function(t){var e=t.split(":");n[e[1].split(".")[1]]=e[0]})),n}:P,M=void 0===(S=O.mapDispatchToPropsFunc)?function(t){return s(t)?function(n){return t(n)}:void 0}:S,L=void 0===(k=O.pageLifecycle)?function(t,n){var e=n.onLoad,r=n.onUnload;n.onLoad=function(n){return g(this,t),h(this,e,arguments)},n.onUnload=function(){return v(this),h(this,r,arguments)}}:k,w=void 0===(_=O.selectorFactory)?y:_,function(t,n){var e=m(t),r=M(n);return x(w,{methodName:"connect",initMapReducers:e,initMapDispatchToProps:r,pageLifecycle:L})});t.Provider=function(t){return i(t),r(t),function(n){return Object.assign({},{store:t},n)}},t.connect=D,Object.defineProperty(t,"__esModule",{value:!0})}));
